<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Test</title>
</head>

<body style="text-align:center;" id="body">
    <a href="index.html">Terug</a><br>
    <h1 style="color:green;">
      Login
    </h1>
 
    <p>
        <input type="text" id="Username" placeholder="Username">
        <input type="password" id="Password" placeholder="Password">
         
        <button onclick="sendJSON()">Bevestig</button>
 
      <p class="result" style="color:green"></p>
     
   </p>

<div id="session"></div>

Nog geen account? <br>
<a href="Register.html">Registreer</a>

<script>
    window.onload = CheckSession
    function CheckSession() {
    if (localStorage.getItem("Ingelogd") == "Ja"){
        alert("Je bent al ingelogd!")
        window.location.href = "index.html";
    }
}



var sessie = document.getElementById("session")


function sendJSON() {
    var User = document.getElementById("Username").value
    var Pass = document.getElementById("Password").value

    fetch('http://127.0.0.1:5000/login', {
        method: "POST",
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
        Username: User,
        Password: Pass
        }),
        })
            .then(response => response.json())
            .then(json => {
                if (json === 'SUCCES'){
                    alert("Je bent ingelogd!")
                    localStorage.setItem("Ingelogd", "Ja");
                    localStorage.setItem("Sessienaam", User);
                    localStorage.setItem("Rol", "Klant");
                    setSession()
                if (User == "Tonie" || User == "Admin"){
                    localStorage.setItem("Rol", "Winkelier");
                    setSession()                    
                }
                }
                else {
                    alert("Voer een correcte gebruikernaam en/of wachtwoord in!")
                }
            })
            .catch(err => console.log('Request Failed', err)); 
}

function setSession(){
Ingelogd = localStorage.getItem("Ingelogd")
Sessienaam = localStorage.getItem("Sessienaam")
Rol = localStorage.getItem("Rol")

sessie.innerHTML = "<b>SESSION</b>" + "<br>" + "Ingelogd: " + Ingelogd + "<br>" + "Gebruiker: " +Sessienaam + "<br>" + "Rol: " +Rol
window.location.href = "index.html";

}


// localstorage 
</script>
</body>
</html>